<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tuğlubey Depo Giriş</title>
  <style>
    body {
      background: #0f172a;
      color: #e2e8f0;
      font-family: system-ui, Arial;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      background: #111827;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 0 20px #0005;
    }
    .card {
      background: #0b1220;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #1f2937;
    }
    h2 {
      margin-top: 0;
      color: #93c5fd;
    }
    input, select {
      width: 100%;
      margin: 6px 0;
      padding: 10px;
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 6px;
      color: #e2e8f0;
    }
    button {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .success { background: #22c55e; color: white; }
    .light { background: #f1f5f9; color: #0f172a; }
    .msg { margin-top: 8px; font-size: 14px; text-align: center; color: #38bdf8; }
    @media (max-width: 900px) {
      .container { grid-template-columns: 1fr; width: 90%; }
    }
  </style>
</head>
<body>

  <div class="container">
    <!-- 🔑 GİRİŞ -->
    <div class="card">
      <h2>🔑 Giriş Yap</h2>
      <input type="email" id="loginEmail" placeholder="E-posta">
      <input type="password" id="loginPass" placeholder="Şifre">
      <button class="success" id="loginBtn">Giriş</button>
      <div id="loginMsg" class="msg"></div>
    </div>

    <!-- 🆕 KAYIT -->
    <div class="card">
      <h2>🆕 Yeni Kayıt</h2>
      <input type="email" id="regEmail" placeholder="E-posta">
      <input type="password" id="regPass" placeholder="Şifre">
      <select id="regRole">
        <option value="sube">Şube</option>
        <option value="yonetici">Yönetici</option>
        <option value="toplayici">Toplayıcı</option>
        <option value="qc">QC</option>
        <option value="palet">Palet</option>
        <option value="admin">Admin</option>
      </select>
      <button class="light" id="regBtn">Kayıt Ol</button>
      <div id="regMsg" class="msg"></div>
    </div>
  </div>

  <!-- 🔥 Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } 
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
    import { getFirestore, doc, setDoc } 
      from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDcLQB4UggXlYA9x8AKw-XybJjcF6U_KA4",
      authDomain: "depo1-4668f.firebaseapp.com",
      projectId: "depo1-4668f",
      storageBucket: "depo1-4668f.appspot.com",
      messagingSenderId: "1044254626353",
      appId: "1:1044254626353:web:148c57df2456cc3d9e3b10",
      measurementId: "G-DFGMVLK9XH"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const loginBtn = document.getElementById("loginBtn");
    const regBtn = document.getElementById("regBtn");

    // 🔑 Giriş
    loginBtn.addEventListener("click", async () => {
      const email = loginEmail.value.trim();
      const pass = loginPass.value.trim();
      loginMsg.textContent = "⏳ Giriş yapılıyor...";
      try {
        const userCred = await signInWithEmailAndPassword(auth, email, pass);
        loginMsg.textContent = "✅ Giriş başarılı! Hoş geldin " + userCred.user.email;
      } catch (err) {
        loginMsg.textContent = "❌ Giriş hatası: " + err.message;
      }
    });

    // 🆕 Kayıt
    regBtn.addEventListener("click", async () => {
      const email = regEmail.value.trim();
      const pass = regPass.value.trim();
      const role = regRole.value;
      regMsg.textContent = "⏳ Kayıt oluşturuluyor...";
      try {
        const userCred = await createUserWithEmailAndPassword(auth, email, pass);
        await setDoc(doc(db, "users", userCred.user.uid), {
          email, role, createdAt: new Date().toISOString()
        });
        regMsg.textContent = "✅ Kayıt başarılı! Artık giriş yapabilirsiniz.";
      } catch (err) {
        regMsg.textContent = "❌ Kayıt hatası: " + err.message;
      }
    });
  </script>

</body>
</html>
